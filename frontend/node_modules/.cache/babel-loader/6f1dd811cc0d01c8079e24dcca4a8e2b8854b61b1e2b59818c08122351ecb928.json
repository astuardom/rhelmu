{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\astuardo\\\\Downloads\\\\project\\\\frontend\\\\src\\\\components\\\\BudgetEditor.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport PatientInfoCard from './PatientInfoCard';\nimport TreatmentItemForm from './TreatmentItemForm';\nimport TreatmentTable from './TreatmentTable';\nimport BudgetSummary from './BudgetSummary';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst validarRut = rut => {\n  if (!rut || rut.length < 8) return false;\n  rut = rut.replace(/\\./g, '').replace('-', '');\n  const cuerpo = rut.slice(0, -1);\n  const dv = rut.slice(-1).toUpperCase();\n  let suma = 0;\n  let multiplo = 2;\n  for (let i = cuerpo.length - 1; i >= 0; i--) {\n    suma += parseInt(cuerpo.charAt(i)) * multiplo;\n    multiplo = multiplo < 7 ? multiplo + 1 : 2;\n  }\n  const dvEsperado = 11 - suma % 11;\n  const dvFinal = dvEsperado === 11 ? '0' : dvEsperado === 10 ? 'K' : dvEsperado.toString();\n  return dv === dvFinal;\n};\nconst BudgetEditor = ({\n  initialPatient = {},\n  budgetToEdit,\n  onSaveBudget,\n  onAddBudget,\n  onUpdateBudget\n}) => {\n  _s();\n  const guardarPresupuesto = onSaveBudget || onAddBudget;\n  const [localPatient, setLocalPatient] = useState({\n    nombre: initialPatient.nombre || '',\n    rut: initialPatient.rut || '',\n    email: initialPatient.email || '',\n    telefono: initialPatient.telefono || ''\n  });\n  const [budget, setBudget] = useState(budgetToEdit || {\n    fecha: new Date().toISOString().split('T')[0],\n    items: [],\n    descuento: 0,\n    notas: '',\n    estado: 'pendiente',\n    confirmado: false\n  });\n  useEffect(() => {\n    if (budgetToEdit) {\n      setBudget({\n        _id: budgetToEdit._id,\n        fecha: budgetToEdit.fecha || new Date().toISOString().split('T')[0],\n        items: (budgetToEdit.items || []).map(item => {\n          var _item$subtotal;\n          return {\n            ...item,\n            subtotal: (_item$subtotal = item.subtotal) !== null && _item$subtotal !== void 0 ? _item$subtotal : item.cantidad * item.precio\n          };\n        }),\n        descuento: budgetToEdit.descuento || 0,\n        notas: budgetToEdit.notas || '',\n        estado: budgetToEdit.estado || 'pendiente',\n        confirmado: budgetToEdit.confirmado || false\n      });\n      if (budgetToEdit.paciente) {\n        setLocalPatient({\n          nombre: budgetToEdit.paciente.nombre || '',\n          rut: budgetToEdit.paciente.rut || '',\n          email: budgetToEdit.paciente.email || '',\n          telefono: budgetToEdit.paciente.telefono || ''\n        });\n      }\n      setGuardado(true); // Marca como guardado si es edición\n    }\n  }, [budgetToEdit]);\n  const [newItem, setNewItem] = useState({\n    tratamiento: '',\n    cantidad: 1,\n    precio: 0,\n    diente: ''\n  });\n  const [guardado, setGuardado] = useState(false);\n  const budgetRef = useRef();\n  const handleBudgetChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setBudget(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const handlePatientChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setLocalPatient(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const handleItemChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setNewItem(prev => ({\n      ...prev,\n      [name]: name === 'cantidad' || name === 'precio' ? Number(value) : value\n    }));\n  };\n  const addItem = () => {\n    if (!newItem.tratamiento) {\n      alert(\"Debe especificar un tratamiento\");\n      return;\n    }\n    if (newItem.precio <= 0) {\n      alert(\"El precio debe ser mayor a cero\");\n      return;\n    }\n    const itemWithSubtotal = {\n      ...newItem,\n      subtotal: newItem.cantidad * newItem.precio\n    };\n    setBudget(prev => ({\n      ...prev,\n      items: [...prev.items, itemWithSubtotal]\n    }));\n    setNewItem({\n      tratamiento: '',\n      cantidad: 1,\n      precio: 0,\n      diente: ''\n    });\n  };\n  const removeItem = index => {\n    setBudget(prev => ({\n      ...prev,\n      items: prev.items.filter((_, i) => i !== index)\n    }));\n  };\n  const calculateTotal = () => {\n    const subtotal = budget.items.reduce((sum, item) => sum + item.subtotal, 0);\n    const descuento = subtotal * (budget.descuento / 100);\n    return {\n      subtotal,\n      descuento,\n      total: subtotal - descuento\n    };\n  };\n  const handleGuardar = () => {\n    if (!validarRut(localPatient.rut)) {\n      alert(\"⚠️ El RUT ingresado no es válido.\");\n      return;\n    }\n    const fullBudget = {\n      ...budget,\n      paciente: localPatient\n    };\n    if (budgetToEdit && onUpdateBudget) {\n      onUpdateBudget(fullBudget);\n      setGuardado(true);\n      return;\n    }\n    if (guardarPresupuesto) {\n      guardarPresupuesto(fullBudget);\n      setGuardado(true);\n    }\n  };\n  const handleConfirmar = async () => {\n    if (!validarRut(localPatient.rut)) {\n      alert(\"⚠️ El RUT ingresado no es válido.\");\n      return;\n    }\n    if (!guardado) {\n      alert(\"Debe guardar el presupuesto antes de confirmar\");\n      return;\n    }\n    try {\n      const res = await fetch(\"http://localhost:5000/api/pacientes\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          nombre: localPatient.nombre,\n          rut: localPatient.rut,\n          telefono: localPatient.telefono,\n          email: localPatient.email,\n          odontograma: budget.items.map(i => i.diente).filter(Boolean)\n        })\n      });\n      if (res.ok) {\n        setBudget(prev => ({\n          ...prev,\n          confirmado: true\n        }));\n        alert(\"Presupuesto confirmado y paciente registrado.\");\n      } else {\n        alert(\"Error al registrar paciente.\");\n      }\n    } catch (error) {\n      console.error(\"Error confirmando presupuesto:\", error);\n      alert(\"Ocurrió un error al confirmar el presupuesto\");\n    }\n  };\n  const handlePrint = () => {\n    if (!localPatient.nombre || budget.items.length === 0) {\n      alert(\"Complete los datos del paciente y agregue tratamientos antes de imprimir\");\n      return;\n    }\n    const printWindow = window.open('', '_blank');\n    if (!printWindow) {\n      alert(\"No se pudo abrir la ventana de impresión. Por favor, desbloquee los popups.\");\n      return;\n    }\n    const opcionesFecha = {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    };\n    const fechaFormateada = new Date(budget.fecha).toLocaleDateString('es-ES', opcionesFecha);\n    printWindow.document.write(`\n      <html>\n        <head>\n          <title>Presupuesto Dental - ${localPatient.nombre}</title>\n          <style>\n            body {\n              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n              margin: 40px;\n              color: #222;\n            }\n            .header {\n              text-align: center;\n              margin-bottom: 30px;\n              border-bottom: 2px solid #1e40af;\n              padding-bottom: 15px;\n            }\n            .logo {\n              height: 60px;\n              margin-bottom: 10px;\n            }\n            h1 {\n              font-size: 22px;\n              margin: 0;\n            }\n            .subtitle {\n              font-weight: bold;\n              color: #1e40af;\n              font-size: 14px;\n            }\n            .subsubtitle {\n              color: #2563eb;\n              font-size: 13px;\n              margin-bottom: 5px;\n            }\n            .patient-info, .footer {\n              margin-top: 30px;\n              font-size: 14px;\n            }\n            .section-title {\n              font-weight: bold;\n              font-size: 16px;\n              margin-top: 30px;\n              text-decoration: underline;\n              color: #111827;\n            }\n            table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-top: 15px;\n              font-size: 13.5px;\n            }\n            th, td {\n              border: 1px solid #ddd;\n              padding: 8px;\n              text-align: left;\n            }\n            th {\n              background-color: #f0f4f8;\n            }\n            .totals {\n              margin-top: 25px;\n              text-align: right;\n              font-size: 15px;\n              line-height: 1.6;\n            }\n            .notes {\n              margin-top: 20px;\n              font-size: 14px;\n              background-color: #f9fafb;\n              padding: 10px;\n              border-left: 4px solid #2563eb;\n            }\n            .signature {\n              margin-top: 50px;\n              text-align: right;\n              font-size: 14px;\n            }\n            .footer {\n              font-size: 12px;\n              color: #666;\n              text-align: center;\n              margin-top: 60px;\n            }\n          </style>\n        </head>\n        <body>\n          <div class=\"header\">\n            <img src=\"/logo-rhelmu.png\" alt=\"Logo Rhelmu\" class=\"logo\" />\n            <h1>Dr. Mauricio Hurtado Cáceres</h1>\n            <div class=\"subtitle\">Ortodoncia y Ortopedia</div>\n            <div class=\"subsubtitle\">Dentomaxilofacial</div>\n            <div>RUT: 12.917.335-1</div>\n          </div>\n    \n          <h2 class=\"section-title\">PRESUPUESTO DENTAL</h2>\n          <div class=\"patient-info\">\n            <p><strong>Nombre del Paciente:</strong> ${localPatient.nombre}</p>\n            <p><strong>RUT:</strong> ${localPatient.rut || 'No especificado'}</p>\n            <p><strong>Correo:</strong> ${localPatient.email || 'No especificado'}</p>\n            <p><strong>Teléfono:</strong> ${localPatient.telefono || 'No especificado'}</p>\n            <p><strong>Fecha:</strong> ${fechaFormateada}</p>\n          </div>\n    \n          <table>\n            <thead>\n              <tr>\n                <th>Tratamiento</th>\n                <th>Diente</th>\n                <th>Cantidad</th>\n                <th>Precio Unitario</th>\n                <th>Subtotal</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${budget.items.map(item => `\n                <tr>\n                  <td>${item.tratamiento}</td>\n                  <td>${item.diente || '-'}</td>\n                  <td>${item.cantidad}</td>\n                  <td>$${item.precio.toLocaleString('es-CL')}</td>\n                  <td>$${item.subtotal.toLocaleString('es-CL')}</td>\n                </tr>\n              `).join('')}\n            </tbody>\n          </table>\n    \n          <div class=\"totals\">\n            <p><strong>Subtotal:</strong> $${subtotal.toLocaleString('es-CL')}</p>\n            ${budget.descuento > 0 ? `\n              <p><strong>Descuento (${budget.descuento}%):</strong> -$${descuento.toLocaleString('es-CL')}</p>\n            ` : ''}\n            <p><strong>Total:</strong> $${total.toLocaleString('es-CL')}</p>\n          </div>\n    \n          ${budget.notas ? `\n            <div class=\"notes\">\n              <strong>Notas:</strong><br/>\n              ${budget.notas}\n            </div>\n          ` : ''}\n    \n          <div class=\"signature\">\n            ___________________________<br/>\n            Dr. Mauricio Hurtado Cáceres<br/>\n            RUT: 12.917.335-1\n          </div>\n    \n          <div class=\"footer\">\n            Dirección: Lord Cochrane 635, Torre B, piso 10, Oficina 1002, Concepción.<br/>\n            Teléfono: +56 944435569\n          </div>\n    \n          <script>\n            window.onload = function() {\n              setTimeout(() => {\n                window.print();\n                window.close();\n              }, 200);\n            };\n          </script>\n        </body>\n      </html>\n    `);\n    printWindow.document.close();\n  };\n  const {\n    subtotal,\n    descuento,\n    total\n  } = calculateTotal();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-xl shadow-sm p-6\",\n    ref: budgetRef,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-between items-center mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold\",\n        children: \"Presupuesto Dental\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handlePrint,\n          className: \"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg\",\n          children: \"\\uD83D\\uDDA8\\uFE0F Imprimir\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleGuardar,\n          className: `px-4 py-2 ${guardado ? 'bg-green-600' : 'bg-blue-600'} text-white rounded-lg`,\n          children: guardado ? '✓ Guardado' : 'Guardar Presupuesto'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleConfirmar,\n          disabled: !guardado,\n          className: `px-4 py-2 ${!guardado ? 'bg-gray-400' : 'bg-green-600'} text-white rounded-lg`,\n          children: \"Confirmar Presupuesto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PatientInfoCard, {\n      patient: localPatient,\n      onChange: handlePatientChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 mb-1\",\n          children: \"Fecha\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          name: \"fecha\",\n          value: budget.fecha,\n          onChange: handleBudgetChange,\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-lg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 mb-1\",\n          children: \"Descuento (%)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"descuento\",\n          value: budget.descuento,\n          onChange: handleBudgetChange,\n          min: \"0\",\n          max: \"100\",\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-lg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 414,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TreatmentItemForm, {\n      newItem: newItem,\n      onChange: handleItemChange,\n      onAdd: addItem\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 7\n    }, this), budget.items.length > 0 && /*#__PURE__*/_jsxDEV(TreatmentTable, {\n      items: budget.items,\n      onRemove: removeItem\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-3 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"md:col-span-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium mb-1\",\n          children: \"Notas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"notas\",\n          value: budget.notas,\n          onChange: handleBudgetChange,\n          rows: \"4\",\n          className: \"w-full px-3 py-2 border rounded-lg\",\n          placeholder: \"Notas adicionales sobre el presupuesto...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(BudgetSummary, {\n        subtotal: subtotal,\n        descuento: descuento,\n        total: total\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 392,\n    columnNumber: 5\n  }, this);\n};\n_s(BudgetEditor, \"+yt/qe+FvPxF18W+pMsad/C7TxQ=\");\n_c = BudgetEditor;\nexport default BudgetEditor;\nvar _c;\n$RefreshReg$(_c, \"BudgetEditor\");","map":{"version":3,"names":["React","useState","useRef","useEffect","PatientInfoCard","TreatmentItemForm","TreatmentTable","BudgetSummary","jsxDEV","_jsxDEV","validarRut","rut","length","replace","cuerpo","slice","dv","toUpperCase","suma","multiplo","i","parseInt","charAt","dvEsperado","dvFinal","toString","BudgetEditor","initialPatient","budgetToEdit","onSaveBudget","onAddBudget","onUpdateBudget","_s","guardarPresupuesto","localPatient","setLocalPatient","nombre","email","telefono","budget","setBudget","fecha","Date","toISOString","split","items","descuento","notas","estado","confirmado","_id","map","item","_item$subtotal","subtotal","cantidad","precio","paciente","setGuardado","newItem","setNewItem","tratamiento","diente","guardado","budgetRef","handleBudgetChange","e","name","value","target","prev","handlePatientChange","handleItemChange","Number","addItem","alert","itemWithSubtotal","removeItem","index","filter","_","calculateTotal","reduce","sum","total","handleGuardar","fullBudget","handleConfirmar","res","fetch","method","headers","body","JSON","stringify","odontograma","Boolean","ok","error","console","handlePrint","printWindow","window","open","opcionesFecha","weekday","year","month","day","fechaFormateada","toLocaleDateString","document","write","toLocaleString","join","close","className","ref","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","patient","onChange","type","min","max","onAdd","onRemove","rows","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/astuardo/Downloads/project/frontend/src/components/BudgetEditor.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport PatientInfoCard from './PatientInfoCard';\nimport TreatmentItemForm from './TreatmentItemForm';\nimport TreatmentTable from './TreatmentTable';\nimport BudgetSummary from './BudgetSummary';\n\nconst validarRut = (rut) => {\n  if (!rut || rut.length < 8) return false;\n  rut = rut.replace(/\\./g, '').replace('-', '');\n  const cuerpo = rut.slice(0, -1);\n  const dv = rut.slice(-1).toUpperCase();\n\n  let suma = 0;\n  let multiplo = 2;\n  for (let i = cuerpo.length - 1; i >= 0; i--) {\n    suma += parseInt(cuerpo.charAt(i)) * multiplo;\n    multiplo = multiplo < 7 ? multiplo + 1 : 2;\n  }\n\n  const dvEsperado = 11 - (suma % 11);\n  const dvFinal = dvEsperado === 11 ? '0' : dvEsperado === 10 ? 'K' : dvEsperado.toString();\n\n  return dv === dvFinal;\n};\n\nconst BudgetEditor = ({ initialPatient = {}, budgetToEdit, onSaveBudget, onAddBudget, onUpdateBudget }) => {\n  const guardarPresupuesto = onSaveBudget || onAddBudget;\n\n  const [localPatient, setLocalPatient] = useState({\n    nombre: initialPatient.nombre || '',\n    rut: initialPatient.rut || '',\n    email: initialPatient.email || '',\n    telefono: initialPatient.telefono || '',\n  });\n\n  const [budget, setBudget] = useState(budgetToEdit || {\n    fecha: new Date().toISOString().split('T')[0],\n    items: [],\n    descuento: 0,\n    notas: '',\n    estado: 'pendiente',\n    confirmado: false\n  });  \n\n  useEffect(() => {\n    if (budgetToEdit) {\n      setBudget({\n        _id: budgetToEdit._id,\n        fecha: budgetToEdit.fecha || new Date().toISOString().split('T')[0],\n        items: (budgetToEdit.items || []).map(item => ({\n          ...item,\n          subtotal: item.subtotal ?? item.cantidad * item.precio\n        })),\n        descuento: budgetToEdit.descuento || 0,\n        notas: budgetToEdit.notas || '',\n        estado: budgetToEdit.estado || 'pendiente',\n        confirmado: budgetToEdit.confirmado || false\n      });\n  \n      if (budgetToEdit.paciente) {\n        setLocalPatient({\n          nombre: budgetToEdit.paciente.nombre || '',\n          rut: budgetToEdit.paciente.rut || '',\n          email: budgetToEdit.paciente.email || '',\n          telefono: budgetToEdit.paciente.telefono || ''\n        });\n      }\n  \n      setGuardado(true); // Marca como guardado si es edición\n    }\n  }, [budgetToEdit]);\n  \n\n  const [newItem, setNewItem] = useState({\n    tratamiento: '',\n    cantidad: 1,\n    precio: 0,\n    diente: ''\n  });\n\n  const [guardado, setGuardado] = useState(false);\n  const budgetRef = useRef();\n\n  const handleBudgetChange = (e) => {\n    const { name, value } = e.target;\n    setBudget(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handlePatientChange = (e) => {\n    const { name, value } = e.target;\n    setLocalPatient(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleItemChange = (e) => {\n    const { name, value } = e.target;\n    setNewItem(prev => ({\n      ...prev,\n      [name]: name === 'cantidad' || name === 'precio' ? Number(value) : value\n    }));\n  };\n\n  const addItem = () => {\n    if (!newItem.tratamiento) {\n      alert(\"Debe especificar un tratamiento\");\n      return;\n    }\n    if (newItem.precio <= 0) {\n      alert(\"El precio debe ser mayor a cero\");\n      return;\n    }\n\n    const itemWithSubtotal = {\n      ...newItem,\n      subtotal: newItem.cantidad * newItem.precio\n    };\n\n    setBudget(prev => ({\n      ...prev,\n      items: [...prev.items, itemWithSubtotal]\n    }));\n\n    setNewItem({\n      tratamiento: '',\n      cantidad: 1,\n      precio: 0,\n      diente: ''\n    });\n  };\n\n  const removeItem = (index) => {\n    setBudget(prev => ({\n      ...prev,\n      items: prev.items.filter((_, i) => i !== index)\n    }));\n  };\n\n  const calculateTotal = () => {\n    const subtotal = budget.items.reduce((sum, item) => sum + item.subtotal, 0);\n    const descuento = subtotal * (budget.descuento / 100);\n    return {\n      subtotal,\n      descuento,\n      total: subtotal - descuento\n    };\n  };\n\n  const handleGuardar = () => {\n    if (!validarRut(localPatient.rut)) {\n      alert(\"⚠️ El RUT ingresado no es válido.\");\n      return;\n    }\n    const fullBudget = {\n      ...budget,\n      paciente: localPatient\n    };\n  \n    if (budgetToEdit && onUpdateBudget) {\n      onUpdateBudget(fullBudget);\n      setGuardado(true);\n      return;\n    }\n  \n    if (guardarPresupuesto) {\n      guardarPresupuesto(fullBudget);\n      setGuardado(true);\n    }\n  };\n  \n\n  const handleConfirmar = async () => {\n    if (!validarRut(localPatient.rut)) {\n      alert(\"⚠️ El RUT ingresado no es válido.\");\n      return;\n    }\n    \n    if (!guardado) {\n      alert(\"Debe guardar el presupuesto antes de confirmar\");\n      return;\n    }\n\n    try {\n      const res = await fetch(\"http://localhost:5000/api/pacientes\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          nombre: localPatient.nombre,\n          rut: localPatient.rut,\n          telefono: localPatient.telefono,\n          email: localPatient.email,\n          odontograma: budget.items.map(i => i.diente).filter(Boolean)\n        })\n      });\n\n      if (res.ok) {\n        setBudget(prev => ({ ...prev, confirmado: true }));\n        alert(\"Presupuesto confirmado y paciente registrado.\");\n      } else {\n        alert(\"Error al registrar paciente.\");\n      }\n    } catch (error) {\n      console.error(\"Error confirmando presupuesto:\", error);\n      alert(\"Ocurrió un error al confirmar el presupuesto\");\n    }\n  };\n\n  const handlePrint = () => {\n    if (!localPatient.nombre || budget.items.length === 0) {\n      alert(\"Complete los datos del paciente y agregue tratamientos antes de imprimir\");\n      return;\n    }\n\n    const printWindow = window.open('', '_blank');\n    if (!printWindow) {\n      alert(\"No se pudo abrir la ventana de impresión. Por favor, desbloquee los popups.\");\n      return;\n    }\n\n    const opcionesFecha = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };\n    const fechaFormateada = new Date(budget.fecha).toLocaleDateString('es-ES', opcionesFecha);\n\n    printWindow.document.write(`\n      <html>\n        <head>\n          <title>Presupuesto Dental - ${localPatient.nombre}</title>\n          <style>\n            body {\n              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n              margin: 40px;\n              color: #222;\n            }\n            .header {\n              text-align: center;\n              margin-bottom: 30px;\n              border-bottom: 2px solid #1e40af;\n              padding-bottom: 15px;\n            }\n            .logo {\n              height: 60px;\n              margin-bottom: 10px;\n            }\n            h1 {\n              font-size: 22px;\n              margin: 0;\n            }\n            .subtitle {\n              font-weight: bold;\n              color: #1e40af;\n              font-size: 14px;\n            }\n            .subsubtitle {\n              color: #2563eb;\n              font-size: 13px;\n              margin-bottom: 5px;\n            }\n            .patient-info, .footer {\n              margin-top: 30px;\n              font-size: 14px;\n            }\n            .section-title {\n              font-weight: bold;\n              font-size: 16px;\n              margin-top: 30px;\n              text-decoration: underline;\n              color: #111827;\n            }\n            table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-top: 15px;\n              font-size: 13.5px;\n            }\n            th, td {\n              border: 1px solid #ddd;\n              padding: 8px;\n              text-align: left;\n            }\n            th {\n              background-color: #f0f4f8;\n            }\n            .totals {\n              margin-top: 25px;\n              text-align: right;\n              font-size: 15px;\n              line-height: 1.6;\n            }\n            .notes {\n              margin-top: 20px;\n              font-size: 14px;\n              background-color: #f9fafb;\n              padding: 10px;\n              border-left: 4px solid #2563eb;\n            }\n            .signature {\n              margin-top: 50px;\n              text-align: right;\n              font-size: 14px;\n            }\n            .footer {\n              font-size: 12px;\n              color: #666;\n              text-align: center;\n              margin-top: 60px;\n            }\n          </style>\n        </head>\n        <body>\n          <div class=\"header\">\n            <img src=\"/logo-rhelmu.png\" alt=\"Logo Rhelmu\" class=\"logo\" />\n            <h1>Dr. Mauricio Hurtado Cáceres</h1>\n            <div class=\"subtitle\">Ortodoncia y Ortopedia</div>\n            <div class=\"subsubtitle\">Dentomaxilofacial</div>\n            <div>RUT: 12.917.335-1</div>\n          </div>\n    \n          <h2 class=\"section-title\">PRESUPUESTO DENTAL</h2>\n          <div class=\"patient-info\">\n            <p><strong>Nombre del Paciente:</strong> ${localPatient.nombre}</p>\n            <p><strong>RUT:</strong> ${localPatient.rut || 'No especificado'}</p>\n            <p><strong>Correo:</strong> ${localPatient.email || 'No especificado'}</p>\n            <p><strong>Teléfono:</strong> ${localPatient.telefono || 'No especificado'}</p>\n            <p><strong>Fecha:</strong> ${fechaFormateada}</p>\n          </div>\n    \n          <table>\n            <thead>\n              <tr>\n                <th>Tratamiento</th>\n                <th>Diente</th>\n                <th>Cantidad</th>\n                <th>Precio Unitario</th>\n                <th>Subtotal</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${budget.items.map(item => `\n                <tr>\n                  <td>${item.tratamiento}</td>\n                  <td>${item.diente || '-'}</td>\n                  <td>${item.cantidad}</td>\n                  <td>$${item.precio.toLocaleString('es-CL')}</td>\n                  <td>$${item.subtotal.toLocaleString('es-CL')}</td>\n                </tr>\n              `).join('')}\n            </tbody>\n          </table>\n    \n          <div class=\"totals\">\n            <p><strong>Subtotal:</strong> $${subtotal.toLocaleString('es-CL')}</p>\n            ${budget.descuento > 0 ? `\n              <p><strong>Descuento (${budget.descuento}%):</strong> -$${descuento.toLocaleString('es-CL')}</p>\n            ` : ''}\n            <p><strong>Total:</strong> $${total.toLocaleString('es-CL')}</p>\n          </div>\n    \n          ${budget.notas ? `\n            <div class=\"notes\">\n              <strong>Notas:</strong><br/>\n              ${budget.notas}\n            </div>\n          ` : ''}\n    \n          <div class=\"signature\">\n            ___________________________<br/>\n            Dr. Mauricio Hurtado Cáceres<br/>\n            RUT: 12.917.335-1\n          </div>\n    \n          <div class=\"footer\">\n            Dirección: Lord Cochrane 635, Torre B, piso 10, Oficina 1002, Concepción.<br/>\n            Teléfono: +56 944435569\n          </div>\n    \n          <script>\n            window.onload = function() {\n              setTimeout(() => {\n                window.print();\n                window.close();\n              }, 200);\n            };\n          </script>\n        </body>\n      </html>\n    `);\n    \n      \n    printWindow.document.close();\n  };\n\n  const { subtotal, descuento, total } = calculateTotal();\n\n  return (\n    <div className=\"bg-white rounded-xl shadow-sm p-6\" ref={budgetRef}>\n      <div className=\"flex justify-between items-center mb-6\">\n        <h2 className=\"text-xl font-semibold\">Presupuesto Dental</h2>\n        <div className=\"flex space-x-3\">\n          <button onClick={handlePrint} className=\"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg\">🖨️ Imprimir</button>\n          <button onClick={handleGuardar} className={`px-4 py-2 ${guardado ? 'bg-green-600' : 'bg-blue-600'} text-white rounded-lg`}>\n            {guardado ? '✓ Guardado' : 'Guardar Presupuesto'}\n          </button>\n          <button onClick={handleConfirmar} disabled={!guardado} className={`px-4 py-2 ${!guardado ? 'bg-gray-400' : 'bg-green-600'} text-white rounded-lg`}>\n            Confirmar Presupuesto\n          </button>\n        </div>\n      </div>\n\n      <PatientInfoCard patient={localPatient} onChange={handlePatientChange} />\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha</label>\n          <input type=\"date\" name=\"fecha\" value={budget.fecha} onChange={handleBudgetChange} className=\"w-full px-3 py-2 border border-gray-300 rounded-lg\" />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">Descuento (%)</label>\n          <input type=\"number\" name=\"descuento\" value={budget.descuento} onChange={handleBudgetChange} min=\"0\" max=\"100\" className=\"w-full px-3 py-2 border border-gray-300 rounded-lg\" />\n        </div>\n      </div>\n\n      <TreatmentItemForm newItem={newItem} onChange={handleItemChange} onAdd={addItem} />\n\n      {budget.items.length > 0 && (\n        <TreatmentTable items={budget.items} onRemove={removeItem} />\n      )}\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <div className=\"md:col-span-2\">\n          <label className=\"block text-sm font-medium mb-1\">Notas</label>\n          <textarea name=\"notas\" value={budget.notas} onChange={handleBudgetChange} rows=\"4\" className=\"w-full px-3 py-2 border rounded-lg\" placeholder=\"Notas adicionales sobre el presupuesto...\" />\n        </div>\n        <BudgetSummary subtotal={subtotal} descuento={descuento} total={total} />\n      </div>\n    </div>\n  );\n};\n\nexport default BudgetEditor;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAC1D,OAAOC,eAAe,MAAM,mBAAmB;AAC/C,OAAOC,iBAAiB,MAAM,qBAAqB;AACnD,OAAOC,cAAc,MAAM,kBAAkB;AAC7C,OAAOC,aAAa,MAAM,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE5C,MAAMC,UAAU,GAAIC,GAAG,IAAK;EAC1B,IAAI,CAACA,GAAG,IAAIA,GAAG,CAACC,MAAM,GAAG,CAAC,EAAE,OAAO,KAAK;EACxCD,GAAG,GAAGA,GAAG,CAACE,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAACA,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC;EAC7C,MAAMC,MAAM,GAAGH,GAAG,CAACI,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAC/B,MAAMC,EAAE,GAAGL,GAAG,CAACI,KAAK,CAAC,CAAC,CAAC,CAAC,CAACE,WAAW,CAAC,CAAC;EAEtC,IAAIC,IAAI,GAAG,CAAC;EACZ,IAAIC,QAAQ,GAAG,CAAC;EAChB,KAAK,IAAIC,CAAC,GAAGN,MAAM,CAACF,MAAM,GAAG,CAAC,EAAEQ,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;IAC3CF,IAAI,IAAIG,QAAQ,CAACP,MAAM,CAACQ,MAAM,CAACF,CAAC,CAAC,CAAC,GAAGD,QAAQ;IAC7CA,QAAQ,GAAGA,QAAQ,GAAG,CAAC,GAAGA,QAAQ,GAAG,CAAC,GAAG,CAAC;EAC5C;EAEA,MAAMI,UAAU,GAAG,EAAE,GAAIL,IAAI,GAAG,EAAG;EACnC,MAAMM,OAAO,GAAGD,UAAU,KAAK,EAAE,GAAG,GAAG,GAAGA,UAAU,KAAK,EAAE,GAAG,GAAG,GAAGA,UAAU,CAACE,QAAQ,CAAC,CAAC;EAEzF,OAAOT,EAAE,KAAKQ,OAAO;AACvB,CAAC;AAED,MAAME,YAAY,GAAGA,CAAC;EAAEC,cAAc,GAAG,CAAC,CAAC;EAAEC,YAAY;EAAEC,YAAY;EAAEC,WAAW;EAAEC;AAAe,CAAC,KAAK;EAAAC,EAAA;EACzG,MAAMC,kBAAkB,GAAGJ,YAAY,IAAIC,WAAW;EAEtD,MAAM,CAACI,YAAY,EAAEC,eAAe,CAAC,GAAGlC,QAAQ,CAAC;IAC/CmC,MAAM,EAAET,cAAc,CAACS,MAAM,IAAI,EAAE;IACnCzB,GAAG,EAAEgB,cAAc,CAAChB,GAAG,IAAI,EAAE;IAC7B0B,KAAK,EAAEV,cAAc,CAACU,KAAK,IAAI,EAAE;IACjCC,QAAQ,EAAEX,cAAc,CAACW,QAAQ,IAAI;EACvC,CAAC,CAAC;EAEF,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGvC,QAAQ,CAAC2B,YAAY,IAAI;IACnDa,KAAK,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAC7CC,KAAK,EAAE,EAAE;IACTC,SAAS,EAAE,CAAC;IACZC,KAAK,EAAE,EAAE;IACTC,MAAM,EAAE,WAAW;IACnBC,UAAU,EAAE;EACd,CAAC,CAAC;EAEF9C,SAAS,CAAC,MAAM;IACd,IAAIyB,YAAY,EAAE;MAChBY,SAAS,CAAC;QACRU,GAAG,EAAEtB,YAAY,CAACsB,GAAG;QACrBT,KAAK,EAAEb,YAAY,CAACa,KAAK,IAAI,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACnEC,KAAK,EAAE,CAACjB,YAAY,CAACiB,KAAK,IAAI,EAAE,EAAEM,GAAG,CAACC,IAAI;UAAA,IAAAC,cAAA;UAAA,OAAK;YAC7C,GAAGD,IAAI;YACPE,QAAQ,GAAAD,cAAA,GAAED,IAAI,CAACE,QAAQ,cAAAD,cAAA,cAAAA,cAAA,GAAID,IAAI,CAACG,QAAQ,GAAGH,IAAI,CAACI;UAClD,CAAC;QAAA,CAAC,CAAC;QACHV,SAAS,EAAElB,YAAY,CAACkB,SAAS,IAAI,CAAC;QACtCC,KAAK,EAAEnB,YAAY,CAACmB,KAAK,IAAI,EAAE;QAC/BC,MAAM,EAAEpB,YAAY,CAACoB,MAAM,IAAI,WAAW;QAC1CC,UAAU,EAAErB,YAAY,CAACqB,UAAU,IAAI;MACzC,CAAC,CAAC;MAEF,IAAIrB,YAAY,CAAC6B,QAAQ,EAAE;QACzBtB,eAAe,CAAC;UACdC,MAAM,EAAER,YAAY,CAAC6B,QAAQ,CAACrB,MAAM,IAAI,EAAE;UAC1CzB,GAAG,EAAEiB,YAAY,CAAC6B,QAAQ,CAAC9C,GAAG,IAAI,EAAE;UACpC0B,KAAK,EAAET,YAAY,CAAC6B,QAAQ,CAACpB,KAAK,IAAI,EAAE;UACxCC,QAAQ,EAAEV,YAAY,CAAC6B,QAAQ,CAACnB,QAAQ,IAAI;QAC9C,CAAC,CAAC;MACJ;MAEAoB,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC;IACrB;EACF,CAAC,EAAE,CAAC9B,YAAY,CAAC,CAAC;EAGlB,MAAM,CAAC+B,OAAO,EAAEC,UAAU,CAAC,GAAG3D,QAAQ,CAAC;IACrC4D,WAAW,EAAE,EAAE;IACfN,QAAQ,EAAE,CAAC;IACXC,MAAM,EAAE,CAAC;IACTM,MAAM,EAAE;EACV,CAAC,CAAC;EAEF,MAAM,CAACC,QAAQ,EAAEL,WAAW,CAAC,GAAGzD,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM+D,SAAS,GAAG9D,MAAM,CAAC,CAAC;EAE1B,MAAM+D,kBAAkB,GAAIC,CAAC,IAAK;IAChC,MAAM;MAAEC,IAAI;MAAEC;IAAM,CAAC,GAAGF,CAAC,CAACG,MAAM;IAChC7B,SAAS,CAAC8B,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAE,CAACH,IAAI,GAAGC;IAAM,CAAC,CAAC,CAAC;EACjD,CAAC;EAED,MAAMG,mBAAmB,GAAIL,CAAC,IAAK;IACjC,MAAM;MAAEC,IAAI;MAAEC;IAAM,CAAC,GAAGF,CAAC,CAACG,MAAM;IAChClC,eAAe,CAACmC,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAE,CAACH,IAAI,GAAGC;IAAM,CAAC,CAAC,CAAC;EACvD,CAAC;EAED,MAAMI,gBAAgB,GAAIN,CAAC,IAAK;IAC9B,MAAM;MAAEC,IAAI;MAAEC;IAAM,CAAC,GAAGF,CAAC,CAACG,MAAM;IAChCT,UAAU,CAACU,IAAI,KAAK;MAClB,GAAGA,IAAI;MACP,CAACH,IAAI,GAAGA,IAAI,KAAK,UAAU,IAAIA,IAAI,KAAK,QAAQ,GAAGM,MAAM,CAACL,KAAK,CAAC,GAAGA;IACrE,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAMM,OAAO,GAAGA,CAAA,KAAM;IACpB,IAAI,CAACf,OAAO,CAACE,WAAW,EAAE;MACxBc,KAAK,CAAC,iCAAiC,CAAC;MACxC;IACF;IACA,IAAIhB,OAAO,CAACH,MAAM,IAAI,CAAC,EAAE;MACvBmB,KAAK,CAAC,iCAAiC,CAAC;MACxC;IACF;IAEA,MAAMC,gBAAgB,GAAG;MACvB,GAAGjB,OAAO;MACVL,QAAQ,EAAEK,OAAO,CAACJ,QAAQ,GAAGI,OAAO,CAACH;IACvC,CAAC;IAEDhB,SAAS,CAAC8B,IAAI,KAAK;MACjB,GAAGA,IAAI;MACPzB,KAAK,EAAE,CAAC,GAAGyB,IAAI,CAACzB,KAAK,EAAE+B,gBAAgB;IACzC,CAAC,CAAC,CAAC;IAEHhB,UAAU,CAAC;MACTC,WAAW,EAAE,EAAE;MACfN,QAAQ,EAAE,CAAC;MACXC,MAAM,EAAE,CAAC;MACTM,MAAM,EAAE;IACV,CAAC,CAAC;EACJ,CAAC;EAED,MAAMe,UAAU,GAAIC,KAAK,IAAK;IAC5BtC,SAAS,CAAC8B,IAAI,KAAK;MACjB,GAAGA,IAAI;MACPzB,KAAK,EAAEyB,IAAI,CAACzB,KAAK,CAACkC,MAAM,CAAC,CAACC,CAAC,EAAE5D,CAAC,KAAKA,CAAC,KAAK0D,KAAK;IAChD,CAAC,CAAC,CAAC;EACL,CAAC;EAED,MAAMG,cAAc,GAAGA,CAAA,KAAM;IAC3B,MAAM3B,QAAQ,GAAGf,MAAM,CAACM,KAAK,CAACqC,MAAM,CAAC,CAACC,GAAG,EAAE/B,IAAI,KAAK+B,GAAG,GAAG/B,IAAI,CAACE,QAAQ,EAAE,CAAC,CAAC;IAC3E,MAAMR,SAAS,GAAGQ,QAAQ,IAAIf,MAAM,CAACO,SAAS,GAAG,GAAG,CAAC;IACrD,OAAO;MACLQ,QAAQ;MACRR,SAAS;MACTsC,KAAK,EAAE9B,QAAQ,GAAGR;IACpB,CAAC;EACH,CAAC;EAED,MAAMuC,aAAa,GAAGA,CAAA,KAAM;IAC1B,IAAI,CAAC3E,UAAU,CAACwB,YAAY,CAACvB,GAAG,CAAC,EAAE;MACjCgE,KAAK,CAAC,mCAAmC,CAAC;MAC1C;IACF;IACA,MAAMW,UAAU,GAAG;MACjB,GAAG/C,MAAM;MACTkB,QAAQ,EAAEvB;IACZ,CAAC;IAED,IAAIN,YAAY,IAAIG,cAAc,EAAE;MAClCA,cAAc,CAACuD,UAAU,CAAC;MAC1B5B,WAAW,CAAC,IAAI,CAAC;MACjB;IACF;IAEA,IAAIzB,kBAAkB,EAAE;MACtBA,kBAAkB,CAACqD,UAAU,CAAC;MAC9B5B,WAAW,CAAC,IAAI,CAAC;IACnB;EACF,CAAC;EAGD,MAAM6B,eAAe,GAAG,MAAAA,CAAA,KAAY;IAClC,IAAI,CAAC7E,UAAU,CAACwB,YAAY,CAACvB,GAAG,CAAC,EAAE;MACjCgE,KAAK,CAAC,mCAAmC,CAAC;MAC1C;IACF;IAEA,IAAI,CAACZ,QAAQ,EAAE;MACbY,KAAK,CAAC,gDAAgD,CAAC;MACvD;IACF;IAEA,IAAI;MACF,MAAMa,GAAG,GAAG,MAAMC,KAAK,CAAC,qCAAqC,EAAE;QAC7DC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACnB1D,MAAM,EAAEF,YAAY,CAACE,MAAM;UAC3BzB,GAAG,EAAEuB,YAAY,CAACvB,GAAG;UACrB2B,QAAQ,EAAEJ,YAAY,CAACI,QAAQ;UAC/BD,KAAK,EAAEH,YAAY,CAACG,KAAK;UACzB0D,WAAW,EAAExD,MAAM,CAACM,KAAK,CAACM,GAAG,CAAC/B,CAAC,IAAIA,CAAC,CAAC0C,MAAM,CAAC,CAACiB,MAAM,CAACiB,OAAO;QAC7D,CAAC;MACH,CAAC,CAAC;MAEF,IAAIR,GAAG,CAACS,EAAE,EAAE;QACVzD,SAAS,CAAC8B,IAAI,KAAK;UAAE,GAAGA,IAAI;UAAErB,UAAU,EAAE;QAAK,CAAC,CAAC,CAAC;QAClD0B,KAAK,CAAC,+CAA+C,CAAC;MACxD,CAAC,MAAM;QACLA,KAAK,CAAC,8BAA8B,CAAC;MACvC;IACF,CAAC,CAAC,OAAOuB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACtDvB,KAAK,CAAC,8CAA8C,CAAC;IACvD;EACF,CAAC;EAED,MAAMyB,WAAW,GAAGA,CAAA,KAAM;IACxB,IAAI,CAAClE,YAAY,CAACE,MAAM,IAAIG,MAAM,CAACM,KAAK,CAACjC,MAAM,KAAK,CAAC,EAAE;MACrD+D,KAAK,CAAC,0EAA0E,CAAC;MACjF;IACF;IAEA,MAAM0B,WAAW,GAAGC,MAAM,CAACC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC7C,IAAI,CAACF,WAAW,EAAE;MAChB1B,KAAK,CAAC,6EAA6E,CAAC;MACpF;IACF;IAEA,MAAM6B,aAAa,GAAG;MAAEC,OAAO,EAAE,MAAM;MAAEC,IAAI,EAAE,SAAS;MAAEC,KAAK,EAAE,MAAM;MAAEC,GAAG,EAAE;IAAU,CAAC;IACzF,MAAMC,eAAe,GAAG,IAAInE,IAAI,CAACH,MAAM,CAACE,KAAK,CAAC,CAACqE,kBAAkB,CAAC,OAAO,EAAEN,aAAa,CAAC;IAEzFH,WAAW,CAACU,QAAQ,CAACC,KAAK,CAAC;AAC/B;AACA;AACA,wCAAwC9E,YAAY,CAACE,MAAM;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuDF,YAAY,CAACE,MAAM;AAC1E,uCAAuCF,YAAY,CAACvB,GA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}